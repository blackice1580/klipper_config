# This file contains common pin mappings for the BigTreeTech Octopus Pro V1.
# To use this config, the firmware should be compiled for the
# STM32F446 with a "32KiB bootloader" and a "12MHz crystal" clock reference.

[include shell_command.cfg]

[include Hardware/*.cfg]

[include ERCF/ercf_hardware.cfg]
[include ERCF/ercf_parameters.cfg]
[include ERCF/ercf_software.cfg]

[include Macros/*/*.cfg]
[include Macros/Probe/klicky_probe/*.cfg]

[include input_shaper/*.cfg]

[include Variables.cfg]

[save_variables]
filename: /home/pi/klipper_config/ERCF/ercf_vars.cfg

#####################################
###	 MCU X/Y/Z/E Stepper Drivers  ###
#####################################
## Octopus Pro
# [X]       - B Motor Driver 0
# [Y]       - A Motor Driver 1
# [Z Back]  - Z Motor Driver 2
# [Z Left]  - Z Motor Driver 3
# [Z Right] - Z Motor Driver 4
#
###################################
## Toolboard
# [E]       - Toolboard
#
###################################
###  MCU's                      ###
###################################
## Octopus Pro
[mcu]
canbus_uuid: 15c2377aaea6

###################################
## FLY-SHT36 Toolboard
[mcu sht36]
canbus_uuid: fb5fab2e5471

###################################
## huvud Toolboard
#[mcu huvud]
#canbus_uuid: 3ac92d7d01ed

###################################
## Raspberry Pi
[mcu rpi]
serial: /tmp/klipper_host_mcu

###################################
## ERCF
[mcu ercf]
serial: /dev/serial/by-id/usb-Klipper_samd21g18a_7143E4EC3359535120202036071507FF-if00

###################################
###  Printer Settings           ###
###################################
[printer]
kinematics: corexy
max_velocity: 1500
max_accel: 50000
max_accel_to_decel: 50000
square_corner_velocity: 10.0
max_z_velocity: 20
max_z_accel: 100

[firmware_retraction]
retract_length: 0.50
retract_speed: 30
unretract_extra_length: 0
unretract_speed: 30

[probe]
#pin: huvud:PB12
pin: sht36:PA2
x_offset: 2
y_offset: 22
z_offset: 9.500
speed: 5
lift_speed: 10
samples: 3
samples_result: median
sample_retract_dist: 3.0
samples_tolerance: 0.01
samples_tolerance_retries: 3

[gcode_arcs]
resolution: 0.1

[exclude_object]

[virtual_sdcard]
path: ~/gcode_files

[idle_timeout]
timeout: 1800

[pause_resume]

[display_status]

[respond]

[force_move]
enable_force_move: True

[angle extruder_sensor]
sensor_type: as5047d
#sample_period: 0.000400
stepper: extruder
cs_pin: sht36:PC14
spi_bus: spi1

[adxl345]
#cs_pin: huvud:PB1
cs_pin: sht36:PA9
spi_bus: spi2
#cs_pin: rpi:None

[resonance_tester]
accel_chip: adxl345
probe_points:
    152.5, 152.5, 20
#accel_per_hz: 100
#max_smoothing: 0.25  # an example

[linear_movement_vibrations]
accel_chip: adxl345
x_min: 10
x_max: 300
y_min: 10
y_max: 300
output_directory: /home/pi/klipper_config/linear_vibrations/

[input_shaper]
shaper_freq_x: 88.4
shaper_type_x: mzv
shaper_freq_y: 66.8
shaper_type_y: mzv

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [input_shaper]
#*# shaper_type_x = mzv
#*# shaper_freq_x = 95.6
#*# shaper_type_y = zv
#*# shaper_freq_y = 51.2
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 53.974
#*# pid_ki = 2.626
#*# pid_kd = 277.289
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 27.538
#*# pid_ki = 2.384
#*# pid_kd = 79.516
#*#
#*# [angle extruder_sensor]
#*# calibrate =
#*# 	901.2,578.8,248.7,65468.5,65154.7,64837.0,64507.5,64196.5,
#*# 	63886.0,63572.2,63245.4,62935.6,62628.2,62319.9,61993.4,61687.1,
#*# 	61381.5,61075.1,60752.0,60447.3,60142.9,59836.7,59515.2,59212.6,
#*# 	58911.1,58604.4,58280.8,57979.9,57679.2,57369.5,57046.8,56744.1,
#*# 	56441.3,56129.2,55806.0,55500.1,55195.5,54880.2,54555.3,54247.1,
#*# 	53934.6,53615.8,53289.8,52977.0,52660.4,52337.4,52005.9,51689.4,
#*# 	51369.1,51042.9,50705.6,50382.3,50057.6,49729.7,49386.2,49059.1,
#*# 	48729.8,48400.1,48051.9,47721.4,47389.2,47057.4,46704.2,46374.1,
#*# 	46040.4,45704.3,45348.9,45018.8,44687.3,44347.7,43989.9,43661.0,
#*# 	43328.2,42988.8,42634.5,42304.5,41971.3,41630.2,41281.9,40952.6,
#*# 	40618.8,40278.6,39933.0,39603.8,39270.8,38932.7,38589.6,38260.5,
#*# 	37930.6,37595.1,37252.1,36921.4,36595.3,36264.6,35920.2,35590.2,
#*# 	35265.3,34937.8,34594.8,34267.3,33943.8,33615.2,33271.1,32947.4,
#*# 	32627.0,32298.5,31954.8,31634.2,31313.5,30984.7,30643.5,30325.3,
#*# 	30006.2,29677.8,29337.3,29020.2,28697.7,28371.9,28036.3,27719.9,
#*# 	27396.5,27069.6,26736.5,26418.6,26096.1,25769.9,25435.4,25116.7,
#*# 	24794.3,24469.1,24133.5,23810.6,23489.4,23165.0,22825.4,22499.4,
#*# 	22179.8,21852.7,21510.4,21185.0,20861.3,20530.1,20185.3,19860.3,
#*# 	19535.3,19200.7,18851.7,18527.0,18200.5,17863.4,17513.5,17186.6,
#*# 	16857.5,16518.9,16167.7,15840.4,15507.4,15168.0,14818.4,14490.1,
#*# 	14155.7,13818.5,13469.0,13139.9,12806.1,12468.4,12118.6,11789.4,
#*# 	11457.7,11123.2,10772.0,10441.8,10113.8,9781.4,9430.9,9101.3,
#*# 	8774.4,8443.8,8094.7,7767.3,7443.8,7112.8,6764.6,6440.9,
#*# 	6118.9,5787.4,5442.7,5121.1,4802.2,4471.8,4130.4,3808.4,
#*# 	3493.0,3166.0,2826.3,2507.6,2191.1,1867.4,1533.2,1217.4
